package Interviews.acano;

import java.util.Iterator;
import java.util.LinkedList;

/**
 * . Write code in a language of your choice to find the longest 
 *   monotonically increasing contiguous subsequence in a sequence
 *   of integers and reverse it. (750 character max)
 * @author Max
 *
 */
public class Solution {
	
	LinkedList<Integer> list, sub;
	private int listSize, maxLength, smallest;
	
	public int[] get(int[] sequence) {
		list = new LinkedList<Integer>();
		listSize = sequence.length;
		maxLength = 0;
		for (int i : sequence) 
			list.addLast(i);
		sequence = new int[length(0)];
		Iterator<Integer> rev = sub.descendingIterator();
		int i = 0;
		while (rev.hasNext())
			sequence[i++] = rev.next();
		return sequence;
	}
	
	private int length(int start) {
		if (listSize - start < maxLength)
			return maxLength;
		
		Iterator<Integer> i = this.list.listIterator(start);
		int first = i.next();
		
		if (start == 0 || first <= smallest) {//is the first element smaller?
			smallest = first;
			System.out.print("Smallest: " + smallest + " ");
			LinkedList<Integer> sub = new LinkedList<Integer>();
			sub.addLast(first);
			while (i.hasNext()) {
				int next = i.next();
				if (next > sub.getLast())
					sub.add(next);
			}
			print(sub);
			int size = sub.size();
			if (size > maxLength) {
				maxLength = size;
				this.sub = sub;
			}
		}
		return length(++start);
	}
	
	public static void main(String[]args) {
		int[] a = {3, 8,2,3, 4, 12, 2, 10, 6, 14, 1, 9, 5, 13, 3, 11, 7, 15};
		
		int[] b = {
				4, 8,2,3, 4, 12, 2, 10, 6, 14, 1,
				2, 10, 6, 14, 1,9, 5, 13, 3, 11, 7, 15,
				8,2,3, 4, 12, 2, 10, 6, 14,
				8,2,3, 4, 6, 14, 1,9, 5, 13, 
				3, 11, 7, 15, 8,2,3, 4, 12, 2, 
				10, 12, 2, 10, 6, 14, 11, 7, 15, 8,2,3, 4, 12, 2, 
				10, 12, 2, 10, 6, 14,3, 8,2,3, 4, 12, 2, 10, 6, 14, 1,
				2, 10, 6, 14, 1,9, 5, 13, 3, 11, 7, 15,
				8,2,3, 4, 12, 2, 10, 6, 14,
				8,2,3, 4, 6, 14, 1,9, 5, 13, 
				3, 11, 7, 15, 1,2,3,4,5,6,7
				};
		
		
		int[] c = {
				4, 8,2,3, 4, 12, 2, 10, 6, 14, 1,
				2, 10, 6, 14, 1,9, 5, 13, 3, 11, 7, 15,
				8,2,3, 4, 12, 2, 10, 6, 14,
				8,2,3, 4, 6, 14, 1,9, 5, 13, 
				3, 11, 7, 15, 8,2,3, 4, 12, 2, 
				10, 12, 2, 10, 0, 14, 11, 7, 15, 8,2,3, 4, 12, 2, 
				10, 12, 2, 10, 6, 14,3, 8,2,3, 4, 12, 2, 10, 6, 14, 1,
				2, 10, 6, 14, 1,9, 5, 13, 3, 11, 7, 15,
				8,2,3, 4, 12, 2, 10, 6, 14,
				8,2,3, 4, 6, 14, 1,9, 5, 13, 
				3, 11, 7, 15, 1,2,3,4,5,6,7
				};
		Solution s = new Solution();
//		System.out.print("Solution A: ");
//		print(s.get(a));
//		System.out.println();
//		System.out.print("Solution B: ");
//		print(s.get(b));
//		System.out.println();
		System.out.print("Solution C: ");
		print(s.get(c));
		
	}
	
	static <T> void print(LinkedList<T> o) {
		Iterator<T> i = o.iterator();
		print(i);
	}
	
	static <T>void print(Iterator<T> i) {
		System.out.print("[ " + i.next());
		while (i.hasNext())
			System.out.print(", " + i.next());
		System.out.print(" ]\n");
	}
	
	static void print(int[] o) {
		System.out.print("[ " + o[0]);
		for (int i = 1;i<o.length;++i)
			System.out.print(", " + o[i]);
		System.out.print(" ]\n");
	}
	
}
